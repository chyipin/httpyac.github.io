<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Scripting | httpYac</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/favicon.png">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/icons/apple-touch-icon-152x152.png">
    <meta name="description" content="Quickly and easily send REST, SOAP, GraphQL and gRPC requests">
    <meta name="theme-color" content="#706B69">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/icons/msapplication-icon-144x144.png">
    <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/assets/css/0.styles.f1c581b5.css" as="style"><link rel="preload" href="/assets/js/app.b5f36e11.js" as="script"><link rel="preload" href="/assets/js/3.ccd1c82c.js" as="script"><link rel="preload" href="/assets/js/24.332c34b1.js" as="script"><link rel="preload" href="/assets/js/4.c6f19318.js" as="script"><link rel="prefetch" href="/assets/js/10.8d6d0cf3.js"><link rel="prefetch" href="/assets/js/11.ac08658c.js"><link rel="prefetch" href="/assets/js/12.2dac0e49.js"><link rel="prefetch" href="/assets/js/13.244e7d77.js"><link rel="prefetch" href="/assets/js/14.4eb29f39.js"><link rel="prefetch" href="/assets/js/15.dd50b18f.js"><link rel="prefetch" href="/assets/js/16.66d84680.js"><link rel="prefetch" href="/assets/js/17.fab597d4.js"><link rel="prefetch" href="/assets/js/18.1b343324.js"><link rel="prefetch" href="/assets/js/19.0413be78.js"><link rel="prefetch" href="/assets/js/20.4ee33cf6.js"><link rel="prefetch" href="/assets/js/21.8fe2f800.js"><link rel="prefetch" href="/assets/js/22.a43cf707.js"><link rel="prefetch" href="/assets/js/23.1450971b.js"><link rel="prefetch" href="/assets/js/25.b28c19aa.js"><link rel="prefetch" href="/assets/js/26.56029822.js"><link rel="prefetch" href="/assets/js/27.3064a73b.js"><link rel="prefetch" href="/assets/js/28.488eafb7.js"><link rel="prefetch" href="/assets/js/29.ab6e8cf7.js"><link rel="prefetch" href="/assets/js/5.5aadd259.js"><link rel="prefetch" href="/assets/js/6.3c03cc98.js"><link rel="prefetch" href="/assets/js/7.c9a88e57.js"><link rel="prefetch" href="/assets/js/8.9fb1a0f7.js"><link rel="prefetch" href="/assets/js/9.ad64d078.js"><link rel="prefetch" href="/assets/js/vendors~flowchart.89405d15.js">
    <link rel="stylesheet" href="/assets/css/0.styles.f1c581b5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">httpYac</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/guide/" class="nav-link router-link-active">
  Guide
</a></div><div class="nav-item"><a href="/config/" class="nav-link">
  Configuration
</a></div><div class="nav-item"><a href="/plugins/" class="nav-link">
  Plugins
</a></div> <a href="https://github.com/httpyac/httpyac.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/guide/" class="nav-link router-link-active">
  Guide
</a></div><div class="nav-item"><a href="/config/" class="nav-link">
  Configuration
</a></div><div class="nav-item"><a href="/plugins/" class="nav-link">
  Plugins
</a></div> <a href="https://github.com/httpyac/httpyac.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/guide/" aria-current="page" class="sidebar-link">Overview</a></li><li><section class="sidebar-group depth-0"><a href="/guide/installation" class="sidebar-heading clickable"><span>Installation</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/installation_cli.html" class="sidebar-link">httpyac CLI</a></li><li><a href="/guide/installation_vscode.html" class="sidebar-link">VS Code httpYac</a></li><li><a href="/guide/installation_httpbook.html" class="sidebar-link">httpBook</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Language</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/request.html" class="sidebar-link">Request</a></li><li><a href="/guide/metaData.html" class="sidebar-link">Meta Data</a></li><li><a href="/guide/variables.html" class="sidebar-link">Variables</a></li><li><a href="/guide/environments.html" class="sidebar-link">Environments</a></li><li><a href="/guide/scripting.html" aria-current="page" class="active sidebar-link">Scripting</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide/scripting.html#access-to-variables" class="sidebar-link">Access to Variables</a></li><li class="sidebar-sub-header"><a href="/guide/scripting.html#require" class="sidebar-link">Require</a></li><li class="sidebar-sub-header"><a href="/guide/scripting.html#console" class="sidebar-link">Console</a></li><li class="sidebar-sub-header"><a href="/guide/scripting.html#test" class="sidebar-link">Test</a></li><li class="sidebar-sub-header"><a href="/guide/scripting.html#global-scripts" class="sidebar-link">Global Scripts</a></li><li class="sidebar-sub-header"><a href="/guide/scripting.html#events" class="sidebar-link">Events</a></li><li class="sidebar-sub-header"><a href="/guide/scripting.html#intellij-script" class="sidebar-link">Intellij Script</a></li><li class="sidebar-sub-header"><a href="/guide/scripting.html#how-to-debug-scripts" class="sidebar-link">How to debug scripts</a></li></ul></li><li><a href="/guide/comment.html" class="sidebar-link">Comments</a></li><li><a href="/guide/hooks.html" class="sidebar-link">Hooks</a></li><li><a href="/guide/response.html" class="sidebar-link">Response</a></li></ul></section></li><li><a href="/guide/troubleshooting.html" class="sidebar-link">Troubleshooting</a></li><li><a href="/guide/examples.html" class="sidebar-link">Examples</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="scripting"><a href="#scripting" class="header-anchor">#</a> Scripting</h1> <p>It is possible to use NodeJS scripts. All scripts before the request line are executed before the request is called. All scripts after the request line are executed as soon as the response is received. All exports of the script are stored as variables.</p> <div class="language-http extra-class"><pre class="language-http"><code>{{
  //pre request script
  const crypto = require('crypto');
  const date = new Date();
  const signatureBase64 = crypto.createHmac('sha256', 'secret')
  .update(`${request.method}\u2028${request.url}\u2028${date.getTime()}`).digest(&quot;base64&quot;);
  exports.authDate = date.toUTCString();
  exports.authentcation = `Basic ${signatureBase64}`;
}}
<span class="token request-line"><span class="token method property">GET</span> <span class="token request-target url">https://httpbin.org/anything</span> <span class="token http-version property">HTTP/1.1</span></span>
<span class="token header-name keyword">Date:</span> {{authDate}}
<span class="token header-name keyword">Authentication:</span> {{authentcation}}

{{
  // post request script
  const assert = require('assert');
  test(&quot;authentcation is valid&quot;, () =&gt; {
    assert.equal(response.parsedBody.headers.Authentication, authentcation);
  });
}}</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>If the execution of the script is <code>async</code>, it is necessary to export this Promise. In this case, the program waits for the Promise to be completed.</p></div> <div class="language-http extra-class"><pre class="language-http"><code>{{
  async function wait(){
    const date = new Date();
    await sleep(10000);
    const afterDate = new Date();
    return afterDate.getTime() - date.getTime();
  }
  exports.wait = wait();
}}
<span class="token request-line"><span class="token method property">GET</span> <span class="token request-target url">https://httpbin.org/anything?delay={{wait}}</span> <span class="token http-version property">HTTP/1.1</span></span>
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>Scripts are executed in a custom context/ execution environment. This context should behave identically to <a href="https://nodejs.org/api/vm.html#what-does-it-mean-to-contextify-an-object" target="_blank" rel="noopener noreferrer">NodeJS Default execution environment<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, but there may be variations. These can be bypassed using require.</p></div> <h2 id="access-to-variables"><a href="#access-to-variables" class="header-anchor">#</a> Access to Variables</h2> <p>All Variables already defined can be accessed via the global scope.</p> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>Since all variables are placed on the global scope of the script, they may overwrite other variables. Please use unique variable names</p></div> <p>In addition to the defined variables, the following values are also set on global scope</p> <table><thead><tr><th>name</th> <th>description</th> <th>condition</th></tr></thead> <tbody><tr><td>grpcStream</td> <td>currently active <a href="https://nodejs.org/api/stream.html#writable-streams" target="_blank" rel="noopener noreferrer">Grpc Writable Stream<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td>only if grpc stream is active</td></tr> <tr><td>httpFile</td> <td>current <a href="https://github.com/AnWeber/httpyac/blob/main/src/models/httpFile.ts" target="_blank" rel="noopener noreferrer">httpFile<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td>-</td></tr> <tr><td>httpRegion</td> <td>current <a href="https://github.com/AnWeber/httpyac/blob/main/src/models/httpRegion.ts" target="_blank" rel="noopener noreferrer">httpRegion<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td>-</td></tr> <tr><td>mqttClient</td> <td>currently active <a href="https://github.com/mqttjs/MQTT.js#example" target="_blank" rel="noopener noreferrer">MQTT Client<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td>only if mqtt client is active</td></tr> <tr><td>oauth2Session</td> <td><a href="https://github.com/AnWeber/httpyac/blob/main/src/variables/replacer/oauth/openIdInformation.ts#L6-L14" target="_blank" rel="noopener noreferrer">OAuth2 Response<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td>only if <a href="/guide/variables.html#oauth2-openid-connect">OAuth2/ OpenId Connect</a> is used</td></tr> <tr><td>request</td> <td>request of the next <a href="https://github.com/AnWeber/httpyac/blob/main/src/models/httpRequest.ts" target="_blank" rel="noopener noreferrer">http request<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td>-</td></tr> <tr><td>response</td> <td><a href="https://github.com/AnWeber/httpyac/blob/main/src/models/httpResponse.ts" target="_blank" rel="noopener noreferrer">http response<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> of the last executed request</td> <td>only use it in post request scripts or for responses imported with <code>@forceRef</code></td></tr> <tr><td>sleep</td> <td><a href="https://github.com/AnWeber/httpyac/blob/main/src/utils/promiseUtils.ts#L7" target="_blank" rel="noopener noreferrer">Method<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> to wait for a fixed period of time</td> <td>-</td></tr> <tr><td>test</td> <td>method to simplify <a href="https://github.com/AnWeber/httpyac/blob/main/src/actions/jsAction.ts#L40" target="_blank" rel="noopener noreferrer">tests<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> (<a href="https://github.com/httpyac/httpyac.github.io/blob/main/examples/project/tests/assert.http" target="_blank" rel="noopener noreferrer">assert<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> or <a href="https://github.com/httpyac/httpyac.github.io/blob/main/examples/project/tests/chai.http" target="_blank" rel="noopener noreferrer">chai<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>)</td> <td>-</td></tr> <tr><td>websocketClient</td> <td>currently active <a href="https://www.npmjs.com/package/ws#sending-and-receiving-text-data" target="_blank" rel="noopener noreferrer">Websocket Client<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td>if websocket client is active</td></tr></tbody></table> <h2 id="require"><a href="#require" class="header-anchor">#</a> Require</h2> <p>External scripts can be imported using require, but you need to install dependencies yourself.</p> <div class="language-http extra-class"><div class="highlight-lines"><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br></div><pre class="language-http"><code>
{{
  const { authenticate } = require('./scriptRequire');
  const authDate = new Date();

  exports.authDate = authDate.toUTCString();
  exports.authentication = authenticate(authDate, request);
}}

<span class="token request-line"><span class="token method property">GET</span> <span class="token request-target url">https://httpbin.org/anything</span> <span class="token http-version property">HTTP/1.1</span></span>
<span class="token header-name keyword">Authentication:</span> {{authentication}}
<span class="token header-name keyword">Date:</span> {{authDate}}</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>External dependencies must be installed independently, exceptions are <a href="https://www.npmjs.com/package/@types/vscode" target="_blank" rel="noopener noreferrer">vscode<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, <a href="https://www.npmjs.com/package/got" target="_blank" rel="noopener noreferrer">got<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, <a href="https://www.npmjs.com/package/@grpc/grpc-js" target="_blank" rel="noopener noreferrer">grpc-js<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> and <a href="https://www.npmjs.com/package/httpyac" target="_blank" rel="noopener noreferrer">httpYac<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> Dependency, which are provided from the extension.</p></div> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>Wit</p></div> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p><a href="https://nodejs.org/api/modules.html#modules_require_cache" target="_blank" rel="noopener noreferrer">NodeJS<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> caches all loaded scripts. Since in VS Code the script is executed in the context of the extension, the content of the script is not reloaded. Therefore, the script must be manually removed from the cache.</p></div> <h2 id="console"><a href="#console" class="header-anchor">#</a> Console</h2> <p>The console cannot be accessed in VS Code. Therefore, a separate Console object is provided in the context of the script that redirects the output to the OutputChannel.</p> <div class="language-http extra-class"><pre class="language-http"><code>@foo = https://httpbin.org

{{
  console.info(foo);
}}
</code></pre></div><h2 id="test"><a href="#test" class="header-anchor">#</a> Test</h2> <p>You can write easily test scripts in JavaScript. Tests allow you to ensure that your API is working as expected, to establish that integrations between services are functioning reliably, and to verify that new developments haven't broken any existing functionality. You can also use test code to aid the debugging process when something goes wrong with your API project.</p> <div class="language-http extra-class"><pre class="language-http"><code>
<span class="token request-line"><span class="token method property">GET</span> <span class="token request-target url">https://httpbin.org/json</span> <span class="token http-version property">HTTP/1.1</span></span>
{{
  const { equal } = require('assert');
  test('status code 200', () =&gt; {
    equal(response.statusCode, 200);
  });
}}</code></pre></div><div class="language-http extra-class"><pre class="language-http"><code>
<span class="token request-line"><span class="token method property">GET</span> <span class="token request-target url">https://httpbin.org/json</span> <span class="token http-version property">HTTP/1.1</span></span>

{{
  const { expect } = require('chai');
  test('status code 200', () =&gt; {
    expect(response.statusCode).to.equal(200)
  });
}}</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p><a href="https://github.com/AnWeber/httpyac/blob/790a1b0409bd9eed6ef0ff26a2fc017952d58231/src/models/testFunction.ts#L6-L14" target="_blank" rel="noopener noreferrer">Auxiliary methods<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> are provided for standard tests such as Status and Content-Type</p></div> <div class="language-http extra-class"><pre class="language-http"><code>
<span class="token request-line"><span class="token method property">GET</span> <span class="token request-target url">https://httpbin.org/json</span> <span class="token http-version property">HTTP/1.1</span></span>
{{
  test.status(200);
}}</code></pre></div><h2 id="global-scripts"><a href="#global-scripts" class="header-anchor">#</a> Global Scripts</h2> <p>Scripts with no request in the same region are always executed (Global Scripts).</p> <div class="language-http extra-class"><pre class="language-http"><code>{{
  console.info('on every run')
}}
###
<span class="token request-line"><span class="token method property">GET</span> <span class="token request-target url">https://httpbin.org/json</span> <span class="token http-version property">HTTP/1.1</span></span>
<span class="token request-line"><span class="token method property">GET</span> <span class="token request-target url">https://httpbin.org/json</span> <span class="token http-version property">HTTP/1.1</span></span>

</code></pre></div><h2 id="events"><a href="#events" class="header-anchor">#</a> Events</h2> <p>The normal script registration is executed in order of occurence in http File. For the execution of a request, several steps have to be executed besides the actual request: Replace Variables, Prepare Body, Pretty Print Body. With events scripts can be hooked into concrete steps in this process.</p> <div class="language-http extra-class"><div class="highlight-lines"><div class="highlighted"> </div><br><br><br></div><pre class="language-http"><code>{{@response
  console.info(&quot;on every request&quot;);
}}
<span class="token request-line"><span class="token method property">GET</span> <span class="token request-target url">https://httpbin.org/json</span> <span class="token http-version property">HTTP/1.1</span></span></code></pre></div><p>The following events are possible.</p> <table><thead><tr><th>Events</th> <th>Description</th></tr></thead> <tbody><tr><td>request</td> <td>event triggered before every request (but after replaceVariableHook)</td></tr> <tr><td>streaming</td> <td>event triggered while client streaming</td></tr> <tr><td>response</td> <td>event triggered on response of request</td></tr> <tr><td>responseLogging</td> <td>event triggered on output of response, used for altering output</td></tr> <tr><td>after</td> <td>event triggered after all actions are executed</td></tr></tbody></table> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>The events can be registered automatically globally using <code>+</code>.</p></div> <div class="language-http extra-class"><div class="highlight-lines"><div class="highlighted"> </div><br><br><br><br><br></div><pre class="language-http"><code>{{+after
  console.info(`on every request: ${response.statusCode}`);
}}
###
<span class="token request-line"><span class="token method property">GET</span> <span class="token request-target url">https://httpbin.org/json</span> <span class="token http-version property">HTTP/1.1</span></span>
<span class="token request-line"><span class="token method property">GET</span> <span class="token request-target url">https://httpbin.org/json</span> <span class="token http-version property">HTTP/1.1</span></span></code></pre></div><p>If no event is specified for global registration, the script is executed before every request.</p> <div class="language-http extra-class"><div class="highlight-lines"><div class="highlighted"> </div><br><br><br><br><br><br><br></div><pre class="language-http"><code>{{+
  console.info(&quot;on every request&quot;);
}}
###
<span class="token request-line"><span class="token method property">GET</span> <span class="token request-target url">https://httpbin.org/json</span> <span class="token http-version property">HTTP/1.1</span></span>
<span class="token request-line"><span class="token method property">GET</span> <span class="token request-target url">https://httpbin.org/json</span> <span class="token http-version property">HTTP/1.1</span></span>

</code></pre></div><h2 id="intellij-script"><a href="#intellij-script" class="header-anchor">#</a> Intellij Script</h2> <p>Intellij Scripts are supported. An <a href="https://www.jetbrains.com/help/idea/http-client-reference.html" target="_blank" rel="noopener noreferrer">Http client<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> and <a href="https://www.jetbrains.com/help/idea/http-response-reference.html" target="_blank" rel="noopener noreferrer">response<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> object corresponding to the interface is created and are available in the script.</p> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>The execution environment differs between NodeJS and Intellij (uses Nashorn). Possibly the behavior is not completely identical, to Intellij Execution. If there are problems, please let me know.</p></div> <div class="language-http extra-class"><pre class="language-http"><code><span class="token request-line"><span class="token method property">POST</span> <span class="token request-target url">https://httpbin.org/anything</span> <span class="token http-version property">HTTP/1.1</span></span>
<span class="token header-name keyword">Content-Type:</span> application/x-www-form-urlencoded
<span class="token header-name keyword">accept:</span> application/json

email=user@domain.loc&amp;password=2

&gt; ./intellij.js

<span class="token request-line"><span class="token method property">POST</span> <span class="token request-target url">https://httpbin.org/anything</span> <span class="token http-version property">HTTP/1.1</span></span>
<span class="token header-name keyword">Content-Type:</span> application/x-www-form-urlencoded
<span class="token header-name keyword">accept:</span> application/json

email=user@domain.loc&amp;password=3

&gt; {% client.global.set(&quot;email&quot;, response.body.form.email); %}
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>Intellij scripts are always executed after request. Scripts before Request Line are ignored</p></div> <h2 id="how-to-debug-scripts"><a href="#how-to-debug-scripts" class="header-anchor">#</a> How to debug scripts</h2> <ol><li>Install httpYac cli with <code>npm install httpyac -g</code></li> <li>open Http File in VS Code</li> <li>add <a href="https://developer.mozilla.org/de/docs/Web/JavaScript/Reference/Statements/debugger" target="_blank" rel="noopener noreferrer">debugger;<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> statement in script</li> <li>open <a href="https://code.visualstudio.com/docs/nodejs/nodejs-debugging#_javascript-debug-terminal" target="_blank" rel="noopener noreferrer">Javascript Debug Terminal<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> in VS Code</li> <li>execute command <code>httpyac &lt;file&gt; -l &lt;line&gt;</code></li></ol> <div class="language-http extra-class"><div class="highlight-lines"><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br></div><pre class="language-http"><code>{{
  //pre request script
  const crypto = require('crypto');
  const date = new Date();
  const signatureBase64 = crypto.createHmac('sha256', 'secret')
  .update(`${request.method}\u2028${request.url}\u2028${date.getTime()}`).digest(&quot;base64&quot;);
  debugger;
  exports.authDate = date.toUTCString();
  exports.authentcation = `Basic ${signatureBase64}`;
}}
<span class="token request-line"><span class="token method property">GET</span> <span class="token request-target url">https://httpbin.org/json</span> <span class="token http-version property">HTTP/1.1</span></span>
<span class="token header-name keyword">Date:</span> {{authDate}}
<span class="token header-name keyword">Authentication:</span> {{authentcation}}</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/httpyac/httpyac.github.io/edit/main/docs/guide/scripting.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">12/8/2021, 5:59:52 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/guide/environments.html" class="prev">
        Environments
      </a></span> <span class="next"><a href="/guide/comment.html">
        Comments
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.b5f36e11.js" defer></script><script src="/assets/js/3.ccd1c82c.js" defer></script><script src="/assets/js/24.332c34b1.js" defer></script><script src="/assets/js/4.c6f19318.js" defer></script>
  </body>
</html>
